<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cat.manage.base.dao.SyncDetailDao">

	<cache type="org.mybatis.caches.ehcache.LoggingEhcache"></cache>

	<resultMap type="com.cat.manage.base.domain.SyncDetail" id="SyncDetailResultMap">
		<id property="syncId" column="sync_id"/>
		<result property="syncFlag" column="sync_flag"/>
		<result property="orderType" column="order_type"/>
		<result property="orderId" column="order_id"/>
		<result property="brandId" column="brand_id"/>
		<result property="seriesId" column="series_id"/>
		<result property="singleId" column="single_id"/>
		<result property="isUsable" column="is_usable"/>
		<result property="createDate" column="create_date"/>
		<result property="createBy" column="create_by"/>
	</resultMap>
	
	<!-- 添加同步详情 -->
	<insert id="addDetail" parameterType="com.cat.manage.base.domain.SyncDetail">
		insert into t_single_series_sync_detail (sync_flag, order_type, order_id, brand_id, series_id, single_id, is_usable, create_date, create_by)
		value(#{syncFlag}, #{orderType}, #{orderId}, #{brandId}, #{seriesId}, #{singleId}, #{isUsable}, now(), 'system')
	</insert>
	
	<!-- 查询同步详情 -->
	<select id="queryDetail" parameterType="com.cat.manage.base.domain.SyncDetail" resultMap="SyncDetailResultMap">
		select sync_id, sync_flag, order_type, order_id, brand_id, series_id, single_id, is_usable, create_date, create_by 
		from t_single_series_sync_detail 
		where 1=1
		<if test="syncId != null">
			and sync_id = #{syncId}
		</if>
		<if test="syncFlag != null and syncFlag != ''">
			and sync_flag = #{syncFlag}
		</if>
		<if test="orderType != null and orderType != ''">
			and order_type = #{orderType}
		</if>
		<if test="orderId != null and orderId != ''">
			and order_id = #{orderId}
		</if>
		<if test="brandId != null and brandId != ''">
			and brand_id = #{brandId}
		</if>
		<if test="seriesId != null and seriesId != ''">
			and series_id = #{seriesId}
		</if>
		<if test="singleId != null and singleId != ''">
			and single_id = #{singleId}
		</if>
		<if test="isUsable != null and isUsable != ''">
			and is_usable = #{isUsable}
		</if>
		order by create_date desc
	</select>
	
	<!-- 根据同步详情表唯一编号删除同步记录 -->
	<delete id="deleteDetailBySyncId" parameterType="java.lang.Integer">
		delete from t_single_series_sync_detail where sync_id = #{syncId}
	</delete>
	
	<!-- 根据同步标记删除同步记录 -->
	<delete id="deleteDetailBySyncFlag" parameterType="java.lang.String">
		delete from t_single_series_sync_detail where sync_flag = #{syncFlag}
	</delete>
	
	<!-- 根据订单唯一编号删除同步记录 -->
	<delete id="deleteDetailByOrderId" parameterType="java.lang.Integer">
		delete from t_single_series_sync_detail where order_id = #{orderId}
	</delete>
	
	
</mapper>